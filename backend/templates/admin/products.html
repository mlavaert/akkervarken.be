<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Akkervarken · Producten</title>
  <link rel="stylesheet" href="/static/admin.css">
</head>
<body>
  <div class="page">
    <header>
      <div class="brand">
        <img src="https://akkervarken.be/img/logo.svg" alt="Akkervarken logo" loading="lazy">
        <div>
          <h1>Producten</h1>
          <div class="meta-line">Beheer het assortiment vanuit de backend</div>
        </div>
      </div>
      <div class="nav">
        <a class="nav-link" href="/admin">Overzicht</a>
        <a class="nav-link" href="/admin/orders">Bestellingen</a>
        <a class="nav-link active" href="/admin/products">Producten</a>
      </div>
    </header>

    {% if created or saved or deleted %}
      <div class="notice notice--success">
        {% if created %}Nieuw product opgeslagen.{% endif %}
        {% if saved %}Wijzigingen bewaard.{% endif %}
        {% if deleted %}Product verwijderd.{% endif %}
      </div>
    {% endif %}

    <div class="layout-grid">
      <section class="card">
        <h2>Nieuw product</h2>
        <form method="post" action="/admin/products">
          <input type="hidden" name="is_active" value="true">
          <label for="slug">Slug</label>
          <input id="slug" name="slug" placeholder="bijv. chipolata" required>

          <label for="name">Naam</label>
          <input id="name" name="name" placeholder="Productnaam" required>

          <div class="row">
            <div>
              <label for="price">Prijs (€/kg)</label>
              <input id="price" name="price" type="number" step="0.01" placeholder="19.50" required>
            </div>
            <div>
              <label for="weight_display">Weergave gewicht</label>
              <input id="weight_display" name="weight_display" placeholder="per kg" required>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="packaging_pieces">Verpakking stuks</label>
              <input id="packaging_pieces" name="packaging_pieces" type="number" min="0" placeholder="2">
            </div>
            <div>
              <label for="packaging_grams">Verpakking gram</label>
              <input id="packaging_grams" name="packaging_grams" type="number" min="0" placeholder="500">
            </div>
          </div>

          <label for="description">Beschrijving</label>
          <textarea id="description" name="description" placeholder="Korte omschrijving" required></textarea>

          <label for="ingredients">Ingrediënten (optioneel)</label>
          <textarea id="ingredients" name="ingredients" placeholder="Markdown toegestaan"></textarea>

          <label for="image">Afbeelding (optioneel)</label>
          <input id="image" name="image" placeholder="/img/voorbeeld.jpg">

          <div class="actions">
            <button type="submit" class="primary">Product aanmaken</button>
          </div>
        </form>
      </section>

      <section class="card">
        <h2>Bestaande producten</h2>
        {% for product in products %}
          <article class="product-card">
            <div class="product-header">
              <div class="pill">{{ product.slug }}</div>
              <div class="switch">
                <input type="checkbox" {% if product.is_active %}checked{% endif %} disabled>
                <span>Actief</span>
              </div>
            </div>
            <form id="update-{{ product.id }}" method="post" action="/admin/products/{{ product.id }}/update">
              <label>Slug</label>
              <input name="slug" value="{{ product.slug }}" required>

              <label>Naam</label>
              <input name="name" value="{{ product.name }}" required>

              <div class="inline-row">
                <div>
                  <label>Prijs</label>
                  <input name="price" type="number" step="0.01" value="{{ '%.2f'|format(product.price) }}" required>
                </div>
                <div>
                  <label>Gewicht label</label>
                  <input name="weight_display" value="{{ product.weight_display }}" required>
                </div>
              </div>

              <div class="inline-row">
                <div>
                  <label>Stuks per verpakking</label>
                  <input name="packaging_pieces" type="number" min="0" value="{{ product.packaging_pieces or '' }}">
                </div>
                <div>
                  <label>Gram per verpakking</label>
                  <input name="packaging_grams" type="number" min="0" value="{{ product.packaging_grams or '' }}">
                </div>
              </div>

              <label>Beschrijving</label>
              <textarea name="description">{{ product.description }}</textarea>

              <label>Ingrediënten</label>
              <textarea name="ingredients">{{ product.ingredients or '' }}</textarea>

              <label>Afbeelding</label>
              <input name="image" value="{{ product.image or '' }}">

              <label class="switch">
                <input type="checkbox" name="is_active" value="true" {% if product.is_active %}checked{% endif %}>
                <span>Actief in catalogus</span>
              </label>
            </form>
            <div class="actions">
              <button type="submit" class="primary" form="update-{{ product.id }}">Opslaan</button>
              <form id="delete-{{ product.id }}" method="post" action="/admin/products/{{ product.id }}/delete" onsubmit="return confirm('Zeker weten dat je dit product wil verwijderen?');"></form>
              <button type="submit" class="ghost" form="delete-{{ product.id }}">Verwijderen</button>
            </div>
          </article>
        {% else %}
          <div class="notice notice--info">Nog geen producten in de database.</div>
        {% endfor %}
      </section>
    </div>
  </div>
</body>
</html>
